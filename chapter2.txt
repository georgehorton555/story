This is the second chapter, modified code 